{"version":3,"file":"metadata-workspace-view.element-CEt9ukrj.js","sources":["../../../../Umbraco.Community.ContentAudit.UI/src/section/metadata/workspace/views/metadata-workspace-view.element.ts"],"sourcesContent":["import { css, customElement, html, repeat } from \"@umbraco-cms/backoffice/external/lit\";\r\nimport { UmbLitElement } from \"@umbraco-cms/backoffice/lit-element\";\r\nimport { PageResponseDto } from \"../../../../api\";\r\nimport ContentAuditContext, { CONTENT_AUDIT_CONTEXT_TOKEN } from \"../../../../context/audit.context\";\r\n\r\n@customElement('metadata-audit-workspace')\r\nexport class AuditMetadataWorkspaceElement extends UmbLitElement {\r\n\r\n    #context?: ContentAuditContext;\r\n\r\n    _pagesWithMissingMetadata?: PageResponseDto[] = [];\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        this.consumeContext(CONTENT_AUDIT_CONTEXT_TOKEN, (context) => {\r\n            this.#context = context;\r\n\r\n            this.observe(context.pagesWithMissingMetadata, (pagesWithMissingMetadata) => {\r\n                this._pagesWithMissingMetadata = pagesWithMissingMetadata;\r\n            });\r\n\r\n            this.#context.getPagesWithMissingMetadata();\r\n        });\r\n    }\r\n\r\n    #renderMissingTitlePages() {\r\n        const filtered = this._pagesWithMissingMetadata?.filter(x => x.metaTitle == '') as PageResponseDto[];\r\n\r\n        if (filtered?.length !== 0) {\r\n            return html`\r\n                <uui-box headline=\"Missing meta title\">\r\n                    ${this.#renderTable(filtered)}\r\n                </uui-box>\r\n            `;\r\n        }\r\n    }\r\n\r\n    #renderMissingDescriptionPages() {\r\n        const filtered = this._pagesWithMissingMetadata?.filter(x => x.metaDescription == '') as PageResponseDto[];\r\n\r\n        if (filtered?.length !== 0) {\r\n            return html`\r\n                <uui-box headline=\"Missing meta description\">\r\n                    ${this.#renderTable(filtered)}\r\n                </uui-box>\r\n            `;\r\n        }\r\n    }\r\n\r\n    #renderMissingKeywordPages() {\r\n        const filtered = this._pagesWithMissingMetadata?.filter(x => x.metaKeywords == null) as PageResponseDto[];\r\n\r\n        if (filtered?.length !== 0) {\r\n            return html`\r\n                <uui-box headline=\"Missing meta keywords\">\r\n                    ${this.#renderTable(filtered)}\r\n                </uui-box>\r\n            `;\r\n        }\r\n    }\r\n\r\n    #renderTable(data: PageResponseDto[]) {\r\n        debugger;\r\n        if (data?.length !== 0) {\r\n            return html`\r\n                <uui-table>\r\n                    <uui-table-column></uui-table-column>\r\n                    <uui-table-column></uui-table-column>\r\n                    <uui-table-column></uui-table-column>\r\n                    <uui-table-column></uui-table-column>\r\n                    <uui-table-column></uui-table-column>\r\n\r\n                    <uui-table-head>\r\n                    <uui-table-head-cell>URL</uui-table-head-cell>\r\n                    <uui-table-head-cell>NodeKey</uui-table-head-cell>\r\n                    <uui-table-head-cell>Title</uui-table-head-cell>\r\n                    <uui-table-head-cell>Description</uui-table-head-cell>\r\n                    <uui-table-head-cell>Keywords</uui-table-head-cell>\r\n                    </uui-table-head>\r\n\r\n                    ${repeat(\r\n                        data,\r\n                        (data) => data.id,\r\n                        (data) =>\r\n                            html`\r\n                                <uui-table-row>\r\n                                    <uui-table-cell>${data.url ?? data.canonicalUrl}</uui-table-cell>\r\n                                    <uui-table-cell>\r\n                                        <a href=\"/umbraco/section/content/workspace/document/edit/${data.nodeKey}\">${data.nodeKey}</a>\r\n                                    </uui-table-cell>\r\n                                    <uui-table-cell>${data.metaTitle}</uui-table-cell>\r\n                                    <uui-table-cell>${data.metaDescription}</uui-table-cell>\r\n                                    <uui-table-cell>${data.metaKeywords}</uui-table-cell>\r\n                                </uui-table-row>\r\n                            `\r\n                    )}\r\n                </uui-table>\r\n            `\r\n        }\r\n    }\r\n\r\n    override render() {\r\n        return html`\r\n            <umb-body-layout headline=\"Metadata\">\r\n                <div id=\"main\">\r\n                    ${this.#renderMissingTitlePages()}\r\n                    ${this.#renderMissingDescriptionPages()}\r\n                    ${this.#renderMissingKeywordPages()}\r\n                </div>\r\n            </umb-body-layout>\r\n        `\r\n    }\r\n\r\n    static styles = [\r\n        css`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: block;\r\n\t\t\t\theight: 100%;\r\n\t\t\t\t--uui-tab-background: var(--uui-color-surface);\r\n\t\t\t}\r\n\r\n            \r\n            #main {\r\n                display: flex;\r\n                flex-direction: column;\r\n                gap: var(--uui-size-layout-1);\r\n            }\r\n        `,\r\n    ];\r\n}\r\n\r\nexport default AuditMetadataWorkspaceElement;\r\n\r\ndeclare global {\r\n    interface HTMLElementTagNameMap {\r\n        'metadata-audit-workspace': AuditMetadataWorkspaceElement;\r\n    }\r\n}"],"names":["_context","_AuditMetadataWorkspaceElement_instances","renderMissingTitlePages_fn","renderMissingDescriptionPages_fn","renderMissingKeywordPages_fn","renderTable_fn","AuditMetadataWorkspaceElement","UmbLitElement","__privateAdd","CONTENT_AUDIT_CONTEXT_TOKEN","context","__privateSet","pagesWithMissingMetadata","__privateGet","html","__privateMethod","filtered","_a","x","data","repeat","css","__decorateClass","customElement","AuditMetadataWorkspaceElement$1"],"mappings":";;;;;;;;;wYAAAA,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC;AAMa,IAAAC,IAAN,cAA4CC,EAAc;AAAA,EAM7D,cAAc;AACJ,UAAA,GAPPC,EAAA,MAAAP,CAAA,GAEHO,EAAA,MAAAR,CAAA,GAEA,KAAA,4BAAgD,CAAC,GAKxC,KAAA,eAAeS,GAA6B,CAACC,MAAY;AAC1D,MAAAC,EAAA,MAAKX,GAAWU,CAAA,GAEhB,KAAK,QAAQA,EAAQ,0BAA0B,CAACE,MAA6B;AACzE,aAAK,4BAA4BA;AAAA,MAAA,CACpC,GAEDC,EAAA,MAAKb,GAAS,4BAA4B;AAAA,IAAA,CAC7C;AAAA,EAAA;AAAA,EA+EI,SAAS;AACP,WAAAc;AAAA;AAAA;AAAA,sBAGOC,EAAA,MAAKd,MAAL,KAA+B,IAAA,CAAA;AAAA,sBAC/Bc,EAAA,MAAKd,MAAL,KAAqC,IAAA,CAAA;AAAA,sBACrCc,EAAA,MAAKd,MAAL,KAAiC,IAAA,CAAA;AAAA;AAAA;AAAA;AAAA,EAAA;AAsBvD;AA1HID,IAAA,oBAAA,QAAA;AAFGC,IAAA,oBAAA,QAAA;AAoBHC,IAAwB,WAAG;;AACvB,QAAMc,KAAWC,IAAA,KAAK,8BAAL,gBAAAA,EAAgC,OAAO,CAAKC,MAAAA,EAAE,aAAa;AAExE,OAAAF,KAAA,gBAAAA,EAAU,YAAW;AACd,WAAAF;AAAA;AAAA,sBAEGC,EAAA,MAAKd,GAALI,CAAA,EAAA,KAAA,MAAkBW,CAAS,CAAA;AAAA;AAAA;AAI7C;AAEAb,IAA8B,WAAG;;AAC7B,QAAMa,KAAWC,IAAA,KAAK,8BAAL,gBAAAA,EAAgC,OAAO,CAAKC,MAAAA,EAAE,mBAAmB;AAE9E,OAAAF,KAAA,gBAAAA,EAAU,YAAW;AACd,WAAAF;AAAA;AAAA,sBAEGC,EAAA,MAAKd,GAALI,CAAA,EAAA,KAAA,MAAkBW,CAAS,CAAA;AAAA;AAAA;AAI7C;AAEAZ,IAA0B,WAAG;;AACzB,QAAMY,KAAWC,IAAA,KAAK,8BAAL,gBAAAA,EAAgC,OAAO,CAAKC,MAAAA,EAAE,gBAAgB;AAE3E,OAAAF,KAAA,gBAAAA,EAAU,YAAW;AACd,WAAAF;AAAA;AAAA,sBAEGC,EAAA,MAAKd,GAALI,CAAA,EAAA,KAAA,MAAkBW,CAAS,CAAA;AAAA;AAAA;AAI7C;AAEAX,IAAY,SAACc,GAAyB;AAClC;AACI,OAAAA,KAAA,gBAAAA,EAAM,YAAW;AACV,WAAAL;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAgBGM;AAAA,MACED;AAAA,MACA,CAACA,MAASA,EAAK;AAAA,MACf,CAACA,MACGL;AAAA;AAAA,sDAE0BK,EAAK,OAAOA,EAAK,YAAY;AAAA;AAAA,oGAEiBA,EAAK,OAAO,KAAKA,EAAK,OAAO;AAAA;AAAA,sDAE3EA,EAAK,SAAS;AAAA,sDACdA,EAAK,eAAe;AAAA,sDACpBA,EAAK,YAAY;AAAA;AAAA;AAAA,IAGlD,CAAA;AAAA;AAAA;AAIjB;AA9FSb,EA4GF,SAAS;AAAA,EACZe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAcJ;AA3HSf,IAANgB,EAAA;AAAA,EADNC,EAAc,0BAA0B;AAAA,GAC5BjB,CAAA;AA8Hb,MAAAkB,IAAelB;"}