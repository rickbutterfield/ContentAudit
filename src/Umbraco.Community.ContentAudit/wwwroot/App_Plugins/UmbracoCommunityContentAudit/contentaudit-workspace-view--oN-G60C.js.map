{"version":3,"file":"contentaudit-workspace-view--oN-G60C.js","sources":["../../../../Umbraco.Community.ContentAudit.UI/src/documents/views/contentaudit-workspace-view.ts"],"sourcesContent":["import { UMB_DOCUMENT_WORKSPACE_CONTEXT } from \"@umbraco-cms/backoffice/document\";\r\nimport { UmbElementMixin } from \"@umbraco-cms/backoffice/element-api\";\r\nimport { customElement, html, LitElement, state } from \"@umbraco-cms/backoffice/external/lit\";\r\nimport { UmbRoute, UmbRouterSlotChangeEvent, UmbRouterSlotInitEvent } from \"@umbraco-cms/backoffice/router\";\r\nimport { ContentAuditAllPagesDetailsWorkspaceViewElement } from \"../../section/all-pages/workspace/all-pages/views/all-pages-details-workspace-view.element\";\r\nimport { CONTENT_AUDIT_ALL_PAGES_WORKSPACE_CONTEXT, ContentAuditAllPagesWorkspaceContext } from \"../../section/all-pages/workspace/all-pages/all-pages-workspace.context\";\r\nimport { PageAnalysisDto } from \"../../api\";\r\nimport ContentAuditAllPagesLinksWorkspaceViewElement from \"../../section/all-pages/workspace/all-pages/views/all-pages-links-workspace-view.element\";\r\nimport ContentAuditAllPagesResourcesWorkspaceViewElement from \"../../section/all-pages/workspace/all-pages/views/all-pages-resources-workspace-view.element\";\r\nimport ContentAuditAllPagesImagesWorkspaceViewElement from \"../../section/all-pages/workspace/all-pages/views/all-pages-images-workspace-view.element\";\r\nimport ContentAuditAllPagesIssuesWorkspaceViewElement from \"../../section/all-pages/workspace/all-pages/views/all-pages-issues-workspace-view.element\";\r\n\r\n@customElement('contentaudit-workspace-view')\r\nexport class ContentAuditWorkspaceElement extends UmbElementMixin(LitElement) {\r\n    @state()\r\n    private _documentUnique = '';\r\n\r\n    @state()\r\n    _data?: PageAnalysisDto;\r\n\r\n    @state()\r\n    private _routes: UmbRoute[] = [];\r\n\r\n    @state()\r\n    private _routerPath?: string;\r\n\r\n    @state()\r\n    private _activePath = '';\r\n\r\n    #workspaceContext?: typeof UMB_DOCUMENT_WORKSPACE_CONTEXT.TYPE;\r\n    #contentAuditWorkspaceContext?: typeof CONTENT_AUDIT_ALL_PAGES_WORKSPACE_CONTEXT.TYPE;\r\n\r\n    constructor() {\r\n        super();\r\n\r\n        this.consumeContext(UMB_DOCUMENT_WORKSPACE_CONTEXT, (context) => {\r\n            this.#workspaceContext = context;\r\n\r\n            this.observe(\r\n                this.#workspaceContext?.unique,\r\n                (unique) => {\r\n                    this._documentUnique = unique!;\r\n\r\n                    this.#contentAuditWorkspaceContext = new ContentAuditAllPagesWorkspaceContext(this);\r\n                    this.#contentAuditWorkspaceContext?.load(this._documentUnique);\r\n                },\r\n                '_documentUnique',\r\n            );\r\n        });\r\n\r\n        this.consumeContext(CONTENT_AUDIT_ALL_PAGES_WORKSPACE_CONTEXT, (instance) => {\r\n            this.#contentAuditWorkspaceContext = instance;\r\n            this.observe(this.#contentAuditWorkspaceContext?.data, (data) => {\r\n                this._data = data;\r\n\r\n                if (this._data != null) {\r\n                    if (this._data.pageData?.runId != 0) {\r\n                        this._createRoutes();\r\n                    }\r\n                }\r\n            }, 'umbCollectionItemsObserver');\r\n        });\r\n    }\r\n\r\n    private _createRoutes() {\r\n        const routes: UmbRoute[] = [];\r\n\r\n        routes.push({\r\n            path: `details`,\r\n            component: () => import('../../section/all-pages/workspace/all-pages/views/all-pages-details-workspace-view.element'),\r\n            setup: (component) => {\r\n                (component as ContentAuditAllPagesDetailsWorkspaceViewElement)._data = this._data;\r\n            }\r\n        });\r\n\r\n        routes.push({\r\n            path: `links`,\r\n            component: () => import('../../section/all-pages/workspace/all-pages/views/all-pages-links-workspace-view.element'),\r\n            setup: (component) => {\r\n                (component as ContentAuditAllPagesLinksWorkspaceViewElement)._data = this._data;\r\n            }\r\n        });\r\n\r\n        routes.push({\r\n            path: `images`,\r\n            component: () => import('../../section/all-pages/workspace/all-pages/views/all-pages-images-workspace-view.element'),\r\n            setup: (component) => {\r\n                (component as ContentAuditAllPagesImagesWorkspaceViewElement)._data = this._data;\r\n            }\r\n        });\r\n\r\n        routes.push({\r\n            path: `resources`,\r\n            component: () => import('../../section/all-pages/workspace/all-pages/views/all-pages-resources-workspace-view.element'),\r\n            setup: (component) => {\r\n                (component as ContentAuditAllPagesResourcesWorkspaceViewElement)._data = this._data;\r\n            }\r\n        });\r\n\r\n        routes.push({\r\n            path: `issues`,\r\n            component: () => import('../../section/all-pages/workspace/all-pages/views/all-pages-issues-workspace-view.element'),\r\n            setup: (component) => {\r\n                (component as ContentAuditAllPagesIssuesWorkspaceViewElement)._data = this._data;\r\n            }\r\n        });\r\n\r\n        if (routes.length !== 0) {\r\n            routes.push({\r\n                path: '',\r\n                redirectTo: routes[0].path,\r\n            });\r\n        }\r\n\r\n        routes.push({\r\n            path: `**`,\r\n            component: async () => (await import('@umbraco-cms/backoffice/router')).UmbRouteNotFoundElement,\r\n        });\r\n\r\n        this._routes = routes;\r\n    }\r\n\r\n    override render() {\r\n        return html`\r\n            <umb-body-layout main-no-padding header-fit-height>\r\n                ${this._routes.length !== 0 ?\r\n                html`\r\n                    <uui-tab-group slot=\"header\">\r\n                        <uui-tab\r\n\t\t\t\t\t        label=\"Details\"\r\n\t\t\t\t\t        .active=${this._routerPath + '/details' === this._activePath}\r\n\t\t\t\t\t        .href=${this._routerPath + '/details'}></uui-tab>\r\n\r\n                        <uui-tab\r\n                            label=\"Links\"\r\n                            .active=${this._routerPath + '/links' === this._activePath}\r\n                            .href=${this._routerPath + '/links'}></uui-tab>\r\n\r\n                        <uui-tab\r\n                            label=\"Images\"\r\n                            .active=${this._routerPath + '/images' === this._activePath}\r\n                            .href=${this._routerPath + '/images'}></uui-tab>\r\n\r\n                        <uui-tab\r\n                            label=\"Resources\"\r\n                            .active=${this._routerPath + '/resources' === this._activePath}\r\n                            .href=${this._routerPath + '/resources'}></uui-tab>\r\n\r\n                        <uui-tab\r\n                            label=\"Issues\"\r\n                            .active=${this._routerPath + '/issues' === this._activePath}\r\n                            .href=${this._routerPath + '/issues'}></uui-tab>\r\n                    </uui-tab-group>\r\n\r\n                    <umb-router-slot\r\n\t\t\t\t\t    inherit-addendum\r\n\t\t\t\t\t    .routes=${this._routes}\r\n\t\t\t\t\t    @init=${(event: UmbRouterSlotInitEvent) => {\r\n                    this._routerPath = event.target.absoluteRouterPath;\r\n                }}\r\n\t\t\t\t\t    @change=${(event: UmbRouterSlotChangeEvent) => {\r\n                    this._activePath = event.target.absoluteActiveViewPath || '';\r\n                }}>\r\n\t\t\t\t    </umb-router-slot>`\r\n            : html`\r\n                <uui-box>\r\n                    Run a site audit to see data here\r\n                </uui-box>\r\n                `\r\n            }\r\n            </umb-body-layout>\r\n        `\r\n    }\r\n}\r\n\r\nexport default ContentAuditWorkspaceElement;"],"names":["_workspaceContext","_contentAuditWorkspaceContext","ContentAuditWorkspaceElement","UmbElementMixin","LitElement","__privateAdd","UMB_DOCUMENT_WORKSPACE_CONTEXT","context","__privateSet","_a","__privateGet","unique","ContentAuditAllPagesWorkspaceContext","CONTENT_AUDIT_ALL_PAGES_WORKSPACE_CONTEXT","instance","data","routes","component","html","event","__decorateClass","state","customElement","ContentAuditWorkspaceElement$1"],"mappings":"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"}