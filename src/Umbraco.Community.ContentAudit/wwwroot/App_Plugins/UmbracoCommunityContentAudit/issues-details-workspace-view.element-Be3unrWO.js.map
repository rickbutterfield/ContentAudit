{"version":3,"file":"issues-details-workspace-view.element-Be3unrWO.js","sources":["../../../../Umbraco.Community.ContentAudit.UI/src/section/issues/workspace/issues/views/issues-details-workspace-view.element.ts"],"sourcesContent":["import { UmbLitElement } from \"@umbraco-cms/backoffice/lit-element\";\r\nimport { UMB_WORKSPACE_MODAL, UmbWorkspaceViewElement } from \"@umbraco-cms/backoffice/workspace\";\r\nimport { customElement, state } from \"lit/decorators.js\";\r\nimport { CONTENT_AUDIT_ISSUES_WORKSPACE_CONTEXT } from \"../issues-workspace.context\";\r\nimport { IssueDto } from \"../../../../../api\";\r\nimport { css, html } from \"@umbraco-cms/backoffice/external/lit\";\r\nimport { UMB_EDIT_DOCUMENT_WORKSPACE_PATH_PATTERN } from '@umbraco-cms/backoffice/document';\r\nimport { UmbTextStyles } from \"@umbraco-cms/backoffice/style\";\r\nimport { UmbTableConfig, UmbTableColumn, UmbTableItem } from \"../../../../../interfaces\";\r\nimport { UmbModalRouteBuilder, UmbModalRouteRegistrationController } from \"@umbraco-cms/backoffice/router\";\r\n\r\n@customElement('content-audit-issues-details-workspace-view')\r\nexport class ContentAuditIssuesDetailsWorkspaceViewElement extends UmbLitElement implements UmbWorkspaceViewElement {\r\n\t@state()\r\n\t_data?: IssueDto;\r\n\r\n\t@state()\r\n\tprivate _tableConfig: UmbTableConfig = {\r\n\t\tallowSelection: false,\r\n\t\thideIcon: true\r\n\t};\r\n\r\n\t@state()\r\n\tprivate get _tableColumns(): Array<UmbTableColumn> {\r\n\t\tlet columns: UmbTableColumn[] = [];\r\n\r\n\t\tif (this._data != null) {\r\n\t\t\tcolumns.push({\r\n\t\t\t\tname: this._data?.images != null ? 'URL' : 'Page',\r\n\t\t\t\talias: 'url'\r\n\t\t\t});\r\n\r\n\t\t\tif (this._data?.exposedProperties != null) {\r\n\t\t\t\tif (this._data?.exposedProperties?.length !== 0) {\r\n\t\t\t\t\tthis._data.exposedProperties.forEach(x => {\r\n\t\t\t\t\t\tcolumns.push({ name: x.name!, alias: x.alias!, elementName: x.elementName!, labelTemplate: x.labelTemplate! });\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (this._data?.images != null) {\r\n\t\t\t\tif (this._data?.images?.length !== 0) {\r\n\t\t\t\t\tcolumns.push({\r\n\t\t\t\t\t\tname: 'Found Page',\r\n\t\t\t\t\t\talias: 'foundPage'\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn columns;\r\n\t};\r\n\r\n\t@state()\r\n\tprivate _tableItems: Array<UmbTableItem> = [];\r\n\r\n\t#workspaceContext?: typeof CONTENT_AUDIT_ISSUES_WORKSPACE_CONTEXT.TYPE;\r\n\t#routeBuilder?: UmbModalRouteBuilder;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(CONTENT_AUDIT_ISSUES_WORKSPACE_CONTEXT, (instance) => {\r\n\t\t\tthis.#workspaceContext = instance;\r\n\t\t});\r\n\r\n        this.#registerModalRoute();\r\n\t}\r\n\r\n\t#registerModalRoute() {\r\n\t\tnew UmbModalRouteRegistrationController(this, UMB_WORKSPACE_MODAL)\r\n\t\t\t.addAdditionalPath(':entityType')\r\n\t\t\t.onSetup((params) => {\r\n\t\t\t\treturn { data: { entityType: params.entityType, preset: {} } };\r\n\t\t\t})\r\n\t\t\t.observeRouteBuilder((routeBuilder) => {\r\n\t\t\t\tthis.#routeBuilder = routeBuilder;\r\n\r\n\t\t\t\tthis.#observeCollectionItems();\r\n\t\t\t});\r\n\t}\r\n\r\n\t#observeCollectionItems() {\r\n\t\tif (!this.#workspaceContext) return;\r\n\t\tthis.observe(this.#workspaceContext.data, (data) => {\r\n\t\t\tthis._data = data;\r\n\t\t\tthis.#createTableItems(data);\r\n\t\t}, 'umbCollectionItemsObserver');\r\n\t}\r\n\r\n\t#createTableItems(data: IssueDto | undefined) {\r\n\t\tlet tableItems: UmbTableItem[] | undefined = [];\r\n\r\n\t\tconst routeBuilder = this.#routeBuilder;\r\n\t\tif (!routeBuilder) throw new Error('Route builder not ready');\r\n\r\n\t\tif (data != null) {\r\n\t\t\tif (data.pages?.length !== 0) {\r\n\t\t\t\ttableItems = data?.pages?.map((page) => {\r\n\t\t\t\t\tconst modalEditPath =\r\n\t\t\t\t\t\trouteBuilder({ entityType: 'document' }) +\r\n\t\t\t\t\t\tUMB_EDIT_DOCUMENT_WORKSPACE_PATH_PATTERN.generateLocal({ unique: page.unique! });\r\n\r\n\t\t\t\t\tlet tableItem: UmbTableItem = {\r\n\t\t\t\t\t\tid: page.unique,\r\n\t\t\t\t\t\tdata: [\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tcolumnAlias: 'url',\r\n\t\t\t\t\t\t\t\tvalue: html`<a href=\"${modalEditPath}\">${page.pageData?.url}</a>`\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t]\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tif (this._data?.exposedProperties != null) {\r\n\t\t\t\t\t\tif (this._data?.exposedProperties?.length !== 0) {\r\n\t\t\t\t\t\t\tthis._data.exposedProperties.forEach(x => {\r\n\t\t\t\t\t\t\t\tconst key = x.alias as keyof typeof page;\r\n\t\t\t\t\t\t\t\ttableItem.data.push({ columnAlias: x.alias!, value: x.labelTemplate ?? page[key] });\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn tableItem;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif (data?.images != null) {\r\n\t\t\t\tif (data?.images.length !== 0) {\r\n\t\t\t\t\ttableItems = data?.images?.map((page) => {\r\n\t\t\t\t\t\tlet tableItem: UmbTableItem = {\r\n\t\t\t\t\t\t\tid: page.unique,\r\n\t\t\t\t\t\t\tdata: [\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tcolumnAlias: 'url',\r\n\t\t\t\t\t\t\t\t\tvalue: page.url\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tcolumnAlias: 'foundPage',\r\n\t\t\t\t\t\t\t\t\tvalue: page.foundPage\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn tableItem;\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n        this._tableItems = tableItems || [];\r\n\t}\r\n\r\n\t#renderPages() {\r\n\t\treturn html`\r\n\t\t\t<div>\r\n\t\t\t\t<umb-table\r\n\t\t\t\t\t.config=${this._tableConfig}\r\n\t\t\t\t\t.columns=${this._tableColumns}\r\n\t\t\t\t\t.items=${this._tableItems}>\r\n\t\t\t\t</umb-table>\r\n\t\t\t</div>\r\n\t\t`\r\n\t}\r\n\r\n\t#renderProperties() {\r\n\t\treturn html`\r\n\t\t\t<uui-box style=\"align-self: flex-start;\">\r\n\t\t\t\t<umb-property-layout label=\"Name\" orientation=\"vertical\" style=\"padding-top: 0;\">\r\n\t\t\t\t\t<div slot=\"editor\">${this._data?.name}</div>\r\n\t\t\t\t</umb-property-layout>\r\n\t\t\t\t<umb-property-layout label=\"Category\" orientation=\"vertical\">\r\n\t\t\t\t\t<div slot=\"editor\">${this._data?.category}</div>\r\n\t\t\t\t</umb-property-layout>\r\n\t\t\t\t<umb-property-layout label=\"Description\" orientation=\"vertical\">\r\n\t\t\t\t\t<div slot=\"editor\">${this._data?.description}</div>\r\n\t\t\t\t</umb-property-layout>\r\n\r\n\t\t\t\t<umb-property-layout label=\"Issue Type\" orientation=\"vertical\">\r\n\t\t\t\t\t<div slot=\"editor\">\r\n\t\t\t\t\t\t<content-audit-issue-type-label .type=${this._data?.type}></content-audit-issue-type-label>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</umb-property-layout>\r\n\t\t\t\t<umb-property-layout label=\"Issue Priority\" orientation=\"vertical\" style=\"padding-bottom: 0;\">\r\n\t\t\t\t\t<div slot=\"editor\">\r\n\t\t\t\t\t\t<content-audit-priority-type-label .type=${this._data?.priority}></content-audit-priority-type-label>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</umb-property-layout>\r\n\t\t\t</uui-box>\r\n\t\t`\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`\r\n\t\t\t${this.#renderPages()}\r\n\t\t\t${this.#renderProperties()}\r\n\t\t`\r\n\t}\r\n\r\n\tstatic override styles = [\r\n\t\tUmbTextStyles,\r\n\t\tcss`\r\n\t\t\t:host {\r\n\t\t\t\tdisplay: grid;\r\n\t\t\t\tgap: var(--uui-size-layout-1);\r\n\t\t\t\tpadding: var(--uui-size-layout-1);\r\n\t\t\t\tgrid-template-columns: 1fr 350px;\r\n\t\t\t}\r\n\t\t`\r\n\t]\r\n}\r\n\r\nexport default ContentAuditIssuesDetailsWorkspaceViewElement;\r\n\r\ndeclare global {\r\n\tinterface HTMLElementTagNameMap {\r\n\t\t'content-audit-issues-details-workspace-view': ContentAuditIssuesDetailsWorkspaceViewElement;\r\n\t}\r\n}\r\n"],"names":["_workspaceContext","_routeBuilder","_ContentAuditIssuesDetailsWorkspaceViewElement_instances","registerModalRoute_fn","observeCollectionItems_fn","createTableItems_fn","renderPages_fn","renderProperties_fn","ContentAuditIssuesDetailsWorkspaceViewElement","UmbLitElement","__privateAdd","CONTENT_AUDIT_ISSUES_WORKSPACE_CONTEXT","instance","__privateSet","__privateMethod","columns","_a","_b","_d","_c","x","_e","_g","_f","html","UmbModalRouteRegistrationController","UMB_WORKSPACE_MODAL","params","routeBuilder","__privateGet","data","tableItems","page","modalEditPath","UMB_EDIT_DOCUMENT_WORKSPACE_PATH_PATTERN","tableItem","key","UmbTextStyles","css","__decorateClass","state","customElement","ContentAuditIssuesDetailsWorkspaceViewElement$1"],"mappings":";;;;;;;;;;;;;;;wXAAAA,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC;AAYa,IAAAC,IAAN,cAA4DC,EAAiD;AAAA,EA+CnH,cAAc;AACP,UAAA,GAhDDC,EAAA,MAAAR,CAAA,GAKN,KAAQ,eAA+B;AAAA,MACtC,gBAAgB;AAAA,MAChB,UAAU;AAAA,IACX,GAkCA,KAAQ,cAAmC,CAAC,GAE5CQ,EAAA,MAAAV,CAAA,GACAU,EAAA,MAAAT,CAAA,GAKM,KAAA,eAAeU,GAAwC,CAACC,MAAa;AACzE,MAAAC,EAAA,MAAKb,GAAoBY,CAAA;AAAA,IAAA,CACzB,GAEKE,EAAA,MAAKZ,GAALC,CAAA,EAAA,KAAA,IAAA;AAAA,EAAA;AAAA,EA3CP,IAAY,gBAAuC;;AAClD,QAAIY,IAA4B,CAAC;AAE7B,WAAA,KAAK,SAAS,SACjBA,EAAQ,KAAK;AAAA,MACZ,QAAMC,IAAA,KAAK,UAAL,gBAAAA,EAAY,WAAU,OAAO,QAAQ;AAAA,MAC3C,OAAO;AAAA,IAAA,CACP,KAEGC,IAAA,KAAK,UAAL,gBAAAA,EAAY,sBAAqB,UAChCC,KAAAC,IAAA,KAAK,UAAL,gBAAAA,EAAY,sBAAZ,gBAAAD,EAA+B,YAAW,KACxC,KAAA,MAAM,kBAAkB,QAAQ,CAAKE,MAAA;AACzC,MAAAL,EAAQ,KAAK,EAAE,MAAMK,EAAE,MAAO,OAAOA,EAAE,OAAQ,aAAaA,EAAE,aAAc,eAAeA,EAAE,eAAgB;AAAA,IAAA,CAC7G,KAICC,IAAA,KAAK,UAAL,gBAAAA,EAAY,WAAU,UACrBC,KAAAC,IAAA,KAAK,UAAL,gBAAAA,EAAY,WAAZ,gBAAAD,EAAoB,YAAW,KAClCP,EAAQ,KAAK;AAAA,MACZ,MAAM;AAAA,MACN,OAAO;AAAA,IAAA,CACP,IAKGA;AAAA,EAAA;AAAA,EA6IC,SAAS;AACV,WAAAS;AAAA,KACJV,EAAA,MAAKZ,MAAL,KAAmB,IAAA,CAAA;AAAA,KACnBY,EAAA,MAAKZ,MAAL,KAAwB,IAAA,CAAA;AAAA;AAAA,EAAA;AAe7B;AAzJCF,IAAA,oBAAA,QAAA;AACAC,IAAA,oBAAA,QAAA;AA7CMC,IAAA,oBAAA,QAAA;AAyDNC,IAAmB,WAAG;AACjB,MAAAsB,EAAoC,MAAMC,CAAmB,EAC/D,kBAAkB,aAAa,EAC/B,QAAQ,CAACC,OACF,EAAE,MAAM,EAAE,YAAYA,EAAO,YAAY,QAAQ,CAAA,IAAK,EAC7D,EACA,oBAAoB,CAACC,MAAiB;AACtC,IAAAf,EAAA,MAAKZ,GAAgB2B,CAAA,GAErBd,EAAA,MAAKZ,GAALE,CAAA,EAAA,KAAA,IAAA;AAAA,EAAA,CACA;AACH;AAEAA,IAAuB,WAAG;AACrB,EAACyB,QAAK7B,CAAmB,KAC7B,KAAK,QAAQ6B,EAAA,MAAK7B,CAAkB,EAAA,MAAM,CAAC8B,MAAS;AACnD,SAAK,QAAQA,GACbhB,EAAA,MAAKZ,MAAL,KAAuB,MAAA4B,CAAA;AAAA,KACrB,4BAA4B;AAChC;AAEAzB,IAAiB,SAACyB,GAA4B;;AAC7C,MAAIC,IAAyC,CAAC;AAE9C,QAAMH,IAAeC,EAAK,MAAA5B,CAAA;AAC1B,MAAI,CAAC2B,EAAoB,OAAA,IAAI,MAAM,yBAAyB;AAE5D,EAAIE,KAAQ,WACPd,IAAAc,EAAK,UAAL,gBAAAd,EAAY,YAAW,MAC1Be,KAAad,IAAAa,KAAA,gBAAAA,EAAM,UAAN,gBAAAb,EAAa,IAAI,CAACe,MAAS;;AACvC,UAAMC,IACLL,EAAa,EAAE,YAAY,WAAY,CAAA,IACvCM,EAAyC,cAAc,EAAE,QAAQF,EAAK,QAAS;AAEhF,QAAIG,IAA0B;AAAA,MAC7B,IAAIH,EAAK;AAAA,MACT,MAAM;AAAA,QACL;AAAA,UACC,aAAa;AAAA,UACb,OAAOR,aAAgBS,CAAa,MAAKjB,IAAAgB,EAAK,aAAL,gBAAAhB,EAAe,GAAG;AAAA,QAAA;AAAA,MAC5D;AAAA,IAEF;AAEI,aAAAC,IAAA,KAAK,UAAL,gBAAAA,EAAY,sBAAqB,UAChCC,KAAAC,IAAA,KAAK,UAAL,gBAAAA,EAAY,sBAAZ,gBAAAD,EAA+B,YAAW,KACxC,KAAA,MAAM,kBAAkB,QAAQ,CAAKE,MAAA;AACzC,YAAMgB,IAAMhB,EAAE;AACd,MAAAe,EAAU,KAAK,KAAK,EAAE,aAAaf,EAAE,OAAQ,OAAOA,EAAE,iBAAiBY,EAAKI,CAAG,EAAA,CAAG;AAAA,IAAA,CAClF,GAIID;AAAA,EAAA,MAILL,KAAA,gBAAAA,EAAM,WAAU,SACfA,KAAA,gBAAAA,EAAM,OAAO,YAAW,MAC3BC,KAAaZ,IAAAW,KAAA,gBAAAA,EAAM,WAAN,gBAAAX,EAAc,IAAI,CAACa,OACD;AAAA,IAC7B,IAAIA,EAAK;AAAA,IACT,MAAM;AAAA,MACL;AAAA,QACC,aAAa;AAAA,QACb,OAAOA,EAAK;AAAA,MACb;AAAA,MACA;AAAA,QACC,aAAa;AAAA,QACb,OAAOA,EAAK;AAAA,MAAA;AAAA,IACb;AAAA,EAEF,OAQO,KAAA,cAAcD,KAAc,CAAC;AACzC;AAEAzB,IAAY,WAAG;AACP,SAAAkB;AAAA;AAAA;AAAA,eAGM,KAAK,YAAY;AAAA,gBAChB,KAAK,aAAa;AAAA,cACpB,KAAK,WAAW;AAAA;AAAA;AAAA;AAI7B;AAEAjB,IAAiB,WAAG;;AACZ,SAAAiB;AAAA;AAAA;AAAA,2BAGiBR,IAAA,KAAK,UAAL,gBAAAA,EAAY,IAAI;AAAA;AAAA;AAAA,2BAGhBC,IAAA,KAAK,UAAL,gBAAAA,EAAY,QAAQ;AAAA;AAAA;AAAA,2BAGpBE,IAAA,KAAK,UAAL,gBAAAA,EAAY,WAAW;AAAA;AAAA;AAAA;AAAA;AAAA,+CAKHD,IAAA,KAAK,UAAL,gBAAAA,EAAY,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA,kDAKbG,IAAA,KAAK,UAAL,gBAAAA,EAAY,QAAQ;AAAA;AAAA;AAAA;AAAA;AAKpE;AAjLYb,EA0LI,SAAS;AAAA,EACxB6B;AAAA,EACAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQD;AAlMAC,EAAA;AAAA,EADCC,EAAM;AAAA,GADKhC,EAEZ,WAAA,SAAA,CAAA;AAGQ+B,EAAA;AAAA,EADPC,EAAM;AAAA,GAJKhC,EAKJ,WAAA,gBAAA,CAAA;AAMI+B,EAAA;AAAA,EADXC,EAAM;AAAA,GAVKhC,EAWA,WAAA,iBAAA,CAAA;AA+BJ+B,EAAA;AAAA,EADPC,EAAM;AAAA,GAzCKhC,EA0CJ,WAAA,eAAA,CAAA;AA1CIA,IAAN+B,EAAA;AAAA,EADNE,EAAc,6CAA6C;AAAA,GAC/CjC,CAAA;AAuMb,MAAAkC,IAAelC;"}